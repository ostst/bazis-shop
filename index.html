<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BAZIS Store</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #0f0f0f;
            --card-bg: #181818;
            --accent-color: #ff5722;
            --text-main: #ffffff;
            --text-sec: #888888;
            --border-color: #2a2a2a;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 15px;
            padding-bottom: 80px; 
            -webkit-tap-highlight-color: transparent;
        }

        /* --- –®–ê–ü–ö–ê --- */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between; /* –ö–Ω–æ–ø–∫–∞ —Å–ª–µ–≤–∞, –ª–æ–≥–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background: rgba(15, 15, 15, 0.95); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
            backdrop-filter: blur(10px);
            padding: 15px 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø–∞ –º–∞–≥–∞–∑–∏–Ω–∞ */
        .header-center {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .store-logo-img {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            object-fit: cover;
            border: 1px solid var(--border-color);
        }

        .logo-text { 
            font-size: 22px; 
            font-weight: 800; 
            color: var(--accent-color); 
            text-transform: uppercase; 
            letter-spacing: 1px;
        }

        .back-btn {
            display: none;
            background: transparent;
            border: none;
            color: var(--text-main);
            font-size: 24px;
            cursor: pointer;
            padding: 0 10px;
        }

        /* --- –ó–ê–ì–û–õ–û–í–ö–ò –ë–†–ï–ù–î–û–í –° –õ–û–ì–û --- */
        .brand-header {
            display: flex;
            align-items: center;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 1px solid #222;
        }

        .brand-logo-img {
            width: 32px;
            height: 32px;
            margin-right: 12px;
            border-radius: 6px;
            object-fit: contain;
            background: #fff; /* –ë–µ–ª—ã–π —Ñ–æ–Ω –ø–æ–¥ –ª–æ–≥–æ –±—Ä–µ–Ω–¥–∞, —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ */
            padding: 2px;
        }

        .brand-title { 
            font-size: 24px; 
            font-weight: 700; 
            letter-spacing: -0.5px;
        }

        /* --- –°–ï–¢–ö–ê –ú–ï–ù–Æ --- */
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        .menu-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 15px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: 0.2s;
        }
        .menu-card:active { transform: scale(0.98); border-color: var(--accent-color); }
        .menu-card span { font-weight: 600; font-size: 16px; }

        /* --- –°–ü–ò–°–û–ö –¢–û–í–ê–†–û–í --- */
        .product-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 15px;
        }

        .prod-img {
            width: 100%; height: 220px; object-fit: cover;
            background: #000; border-radius: 8px; margin-bottom: 10px;
        }

        .prod-title { font-size: 18px; font-weight: 700; margin-bottom: 5px; line-height: 1.2; }
        .prod-price { font-size: 18px; color: var(--accent-color); font-weight: bold; margin-bottom: 10px; }

        .prod-details {
            font-size: 12px; color: var(--text-sec);
            display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
            margin-bottom: 15px; background: #111; padding: 10px; border-radius: 8px;
        }
        .detail-row b { color: #fff; margin-right: 4px; }

        .add-btn {
            background: #fff; color: #000;
            border: none; padding: 14px; border-radius: 10px;
            font-weight: 700; width: 100%; cursor: pointer;
            font-size: 14px; text-transform: uppercase;
        }
        .add-btn:active { opacity: 0.8; }

        /* --- –ö–û–†–ó–ò–ù–ê --- */
        .cart-item {
            background: #111; border-radius: 12px; margin-bottom: 10px;
            padding: 15px; display: flex; justify-content: space-between; align-items: center;
            border: 1px solid var(--border-color);
        }
        .cart-item-info { display: flex; flex-direction: column; }
        .remove-btn { color: #ff3b30; background: none; border: none; font-size: 24px; padding: 0 10px; }

        .form-group { margin-bottom: 15px; }
        .form-label { font-size: 12px; color: var(--text-sec); margin-bottom: 8px; display: block; }
        .form-input, .form-select {
            width: 100%; padding: 14px; background: var(--card-bg);
            border: 1px solid var(--border-color); color: #fff; border-radius: 10px;
            font-size: 16px; box-sizing: border-box; -webkit-appearance: none;
        }
        .form-input:focus { border-color: var(--accent-color); outline: none; }

        /* --- –ü–õ–ê–í–ê–Æ–©–ê–Ø –ö–ù–û–ü–ö–ê --- */
        .fab-cart {
            position: fixed; bottom: 25px; right: 20px;
            background: var(--accent-color); color: white;
            width: 56px; height: 56px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 10px 20px rgba(255, 87, 34, 0.3);
            z-index: 200; transition: transform 0.2s;
            font-size: 24px;
        }
        .fab-cart:active { transform: scale(0.9); }
        .cart-count {
            position: absolute; top: -5px; right: -5px;
            background: white; color: var(--accent-color);
            font-size: 12px; font-weight: bold;
            width: 22px; height: 22px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid var(--bg-color);
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <!-- –®–ê–ü–ö–ê -->
    <div class="header">
        <button id="backBtn" class="back-btn" onclick="goHome()">
            <!-- –ò–∫–æ–Ω–∫–∞ —Å—Ç—Ä–µ–ª–∫–∏ –Ω–∞–∑–∞–¥ -->
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
        </button>

        <div class="header-center">
            <!-- –õ–û–ì–û–¢–ò–ü –ú–ê–ì–ê–ó–ò–ù–ê (–ó–ê–ú–ï–ù–ò –°–°–´–õ–ö–£) -->
            <img src="img/logo_bazis.jpeg" class="store-logo-img" alt="BAZIS">
            <div class="logo-text">BAZIS</div>
        </div>

        <div style="width: 40px;"></div> <!-- –ü—É—Å—Ç–æ–π –±–ª–æ–∫ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ -->
    </div>

    <!-- –≠–ö–†–ê–ù 1: –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
    <div id="homePage" class="page active">

        <!-- –õ–û–ì–û + STONE ISLAND -->
        <div class="brand-header">
            <!-- –õ–û–ì–û SI (–ó–ê–ú–ï–ù–ò –°–°–´–õ–ö–£) -->
            <img src="img/stone island.jpg" class="brand-logo-img">
            <div class="brand-title">Stone Island</div>
        </div>

        <div class="grid">
            <div class="menu-card" onclick="openCategory('Stone Island', 'T-Shirts')">
                <span>üëï –§—É—Ç–±–æ–ª–∫–∏</span>
            </div>
            <div class="menu-card" onclick="openCategory('Stone Island', 'Hoodies')">
                <span>üß• –•—É–¥–∏</span>
            </div>
            <div class="menu-card" onclick="openCategory('Stone Island', 'Outerwear')">
                <span>üå® –í–µ—Ä—Ö–Ω—è—è</span>
            </div>
            <div class="menu-card" style="border-color: var(--accent-color);" onclick="openCategory('Stone Island', 'Vintage')">
                <span style="color: var(--accent-color)">üíé –í–∏–Ω—Ç–∞–∂</span>
            </div>
             <div class="menu-card" onclick="openCategory('Stone Island', 'Accessories')">
                <span>üß¢ –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</span>
            </div>
        </div>

        <!-- –õ–û–ì–û + C.P. COMPANY -->
        <div class="brand-header">
             <!-- –õ–û–ì–û CP (–ó–ê–ú–ï–ù–ò –°–°–´–õ–ö–£) -->
            <img src="img/c. p. company.jpg" class="brand-logo-img">
            <div class="brand-title">C.P. Company</div>
        </div>

        <div class="grid">
            <div class="menu-card" onclick="openCategory('CP Company', 'T-Shirts')">
                <span>üëï –§—É—Ç–±–æ–ª–∫–∏</span>
            </div>
            <div class="menu-card" onclick="openCategory('CP Company', 'Hoodies')">
                <span>üß• –•—É–¥–∏</span>
            </div>
            <div class="menu-card" onclick="openCategory('CP Company', 'Outerwear')">
                <span>üå® –í–µ—Ä—Ö–Ω—è—è</span>
            </div>
             <div class="menu-card" onclick="openCategory('CP Company', 'Accessories')">
                <span>üß¢ –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</span>
            </div>
        </div>
    </div>

    <!-- –≠–ö–†–ê–ù 2: –°–ü–ò–°–û–ö –¢–û–í–ê–†–û–í -->
    <div id="productsPage" class="page">
        <h2 id="categoryTitle" style="margin-bottom: 20px; font-size: 22px;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</h2>
        <div id="productsList"></div>
    </div>

    <!-- –≠–ö–†–ê–ù 3: –ö–û–†–ó–ò–ù–ê –ò –û–§–û–†–ú–õ–ï–ù–ò–ï -->
    <div id="cartPage" class="page">
        <h2 style="margin-bottom: 20px;">–í–∞—à –∑–∞–∫–∞–∑</h2>

        <div id="cartItemsList"></div>

        <div style="border-top: 1px solid #222; margin: 30px 0;"></div>

        <h3 style="margin-bottom: 15px; color: var(--accent-color)">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h3>
        <div class="form-group">
            <label class="form-label">–§–ò–û</label>
            <input type="text" class="form-input" id="inputName" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
        </div>
        <div class="form-group">
            <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="tel" class="form-input" id="inputPhone" placeholder="+7 900 ...">
        </div>
        <div class="form-group">
            <label class="form-label">–ù–∏–∫ –≤ Telegram</label>
            <input type="text" class="form-input" id="inputNick" placeholder="@username">
        </div>
        <div class="form-group">
            <label class="form-label">–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏</label>
            <select class="form-select" id="inputDelivery">
                <option value="cdek">–°–î–≠–ö (–¥–æ –ø—É–Ω–∫—Ç–∞ –≤—ã–¥–∞—á–∏)</option>
                <option value="yandex">–Ø–Ω–¥–µ–∫—Å –î–æ—Å—Ç–∞–≤–∫–∞</option>
                <option value="pickup">–°–∞–º–æ–≤—ã–≤–æ–∑ (–ú–æ—Å–∫–≤–∞)</option>
            </select>
        </div>
    </div>

    <!-- –ü–õ–ê–í–ê–Æ–©–ê–Ø –ö–ù–û–ü–ö–ê –ö–û–†–ó–ò–ù–´ -->
    <div class="fab-cart" onclick="openCart()">
        üõí
        <div class="cart-count" id="cartCount">0</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        tg.MainButton.color = "#ff5722"; 
        tg.MainButton.textColor = "#ffffff";

        // –¶–≤–µ—Ç–∞ —à–∞–ø–∫–∏ TG
        tg.setHeaderColor('#0f0f0f'); 
        tg.setBackgroundColor('#0f0f0f');

        // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• (–î–û–ë–ê–í–õ–Ø–ô –°–Æ–î–ê –¢–û–í–ê–†–´) ---
        const PRODUCTS_DB = [
            {
                id: 1,
                brand: 'Stone Island',
                category: 'T-Shirts',
                title: 'Archivio Tee Black',
                price: 18500,
                size: 'L',
                color: 'Black',
                condition: 'New',
                composition: '100% Cotton',
                cert: 'CLG 123...',
                img: 'https://image.goxip.com/u4g1y8y_s2r4s3r8x4t2r5u2u2/stone-island-white-scraping-t-shirt.jpg'
            },
            {
                id: 2,
                brand: 'Stone Island',
                category: 'Hoodies',
                title: 'Shadow Project Hoodie',
                price: 45000,
                size: 'XL',
                color: 'Olive',
                condition: '9/10',
                composition: 'Fleece',
                cert: 'QR Valid',
                img: 'https://cdn-images.farfetch-contents.com/17/60/89/24/17608924_36852642_1000.jpg'
            },
            {
                id: 3,
                brand: 'CP Company',
                category: 'Outerwear',
                title: 'DD Shell Jacket',
                price: 52000,
                size: '52 (L)',
                color: 'Grey',
                condition: 'New',
                composition: 'Nylon',
                cert: 'Certilogo',
                img: 'https://cdn-images.farfetch-contents.com/19/52/47/48/19524748_43431995_1000.jpg'
            },
            {
                id: 4,
                brand: 'CP Company',
                category: 'Accessories',
                title: 'Goggle Beanie',
                price: 12500,
                size: 'OS',
                color: 'Black',
                condition: 'New',
                composition: 'Wool',
                cert: 'Tags',
                img: 'https://img01.ztat.net/article/spp-media-p1/d4c5322c15e34d3881b78468e2447c60/857ec713f43644938177d606073f4a4f.jpg?imwidth=1800'
            }
        ];

        let cart = [];

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
        function addToCart(productId) {
            const product = PRODUCTS_DB.find(p => p.id === productId);
            if(product) {
                cart.push(product);
                updateCartUI();
                tg.HapticFeedback.notificationOccurred('success');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
            renderCartPage();
            tg.HapticFeedback.selectionChanged();
        }

        function updateCartUI() {
            document.getElementById('cartCount').innerText = cart.length;

            if (cart.length > 0 && document.getElementById('cartPage').style.display === 'block') {
                tg.MainButton.show();
                tg.MainButton.setText(`–û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó ‚Ä¢ ${calculateTotal().toLocaleString()} ‚ÇΩ`);
            } else {
                tg.MainButton.hide();
            }
        }

        function calculateTotal() {
            return cart.reduce((sum, item) => sum + item.price, 0);
        }

        // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');

            const backBtn = document.getElementById('backBtn');
            // –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤–∏–¥–Ω–∞ –≤–µ–∑–¥–µ, –∫—Ä–æ–º–µ –≥–ª–∞–≤–Ω–æ–π
            if (pageId === 'homePage') {
                backBtn.style.display = 'none';
                tg.MainButton.hide();
            } else {
                backBtn.style.display = 'block';
            }

            // –ï—Å–ª–∏ —É—à–ª–∏ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã, –ø—Ä—è—á–µ–º MainButton (—á—Ç–æ–±—ã –æ–Ω–∞ –Ω–µ –≤–∏—Å–µ–ª–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ)
            if (pageId !== 'cartPage') {
                tg.MainButton.hide();
            } else {
                // –ï—Å–ª–∏ –≤–µ—Ä–Ω—É–ª–∏—Å—å –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ —Ç–∞–º —á—Ç–æ-—Ç–æ –µ—Å—Ç—å
                updateCartUI();
            }

            window.scrollTo(0,0);
        }

        function goHome() {
            showPage('homePage');
        }

        function openCategory(brand, category) {
            const list = document.getElementById('productsList');
            document.getElementById('categoryTitle').innerHTML = `<span style="color:var(--text-sec)">${brand}</span> / ${category}`;
            list.innerHTML = '';

            const items = PRODUCTS_DB.filter(p => p.brand === brand && p.category === category);

            if (items.length === 0) {
                list.innerHTML = '<div style="text-align:center; padding:40px; color:#555">–ü—É—Å—Ç–æ üå™</div>';
            }

            items.forEach(item => {
                const el = document.createElement('div');
                el.className = 'product-card';
                el.innerHTML = `
                    <img src="${item.img}" class="prod-img" onclick="previewImage('${item.img}')">
                    <div class="prod-title">${item.title}</div>
                    <div class="prod-price">${item.price.toLocaleString()} ‚ÇΩ</div>

                    <div class="prod-details">
                        <div class="detail-row"><b>–†–∞–∑–º–µ—Ä:</b> ${item.size}</div>
                        <div class="detail-row"><b>–¶–≤–µ—Ç:</b> ${item.color}</div>
                        <div class="detail-row"><b>–°–æ—Å—Ç:</b> ${item.condition}</div>
                        <div class="detail-row"><b>CLG/QR:</b> ${item.cert}</div>
                        <div class="detail-row" style="grid-column: span 2; border-top: 1px solid #333; padding-top:5px; margin-top:5px;">
                            <b>–°–æ—Å—Ç–∞–≤:</b> ${item.composition}
                        </div>
                    </div>

                    <button class="add-btn" onclick="addToCart(${item.id})">–í –∫–æ—Ä–∑–∏–Ω—É +</button>
                `;
                list.appendChild(el);
            });

            showPage('productsPage');
        }

        function openCart() {
            renderCartPage();
            showPage('cartPage');
        }

        function renderCartPage() {
            const list = document.getElementById('cartItemsList');
            list.innerHTML = '';

            if (cart.length === 0) {
                list.innerHTML = '<div style="text-align:center; padding:40px; color:#555">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>';
                return;
            }

            cart.forEach((item, index) => {
                const el = document.createElement('div');
                el.className = 'cart-item';
                el.innerHTML = `
                    <div class="cart-item-info">
                        <span style="font-weight:bold; font-size:14px;">${item.title}</span>
                        <span style="font-size:12px; color:#888; margin-top:4px;">${item.size} | ${item.price.toLocaleString()} ‚ÇΩ</span>
                    </div>
                    <button class="remove-btn" onclick="removeFromCart(${index})">√ó</button>
                `;
                list.appendChild(el);
            });
        }

        // --- –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• –ë–û–¢–£ ---
        Telegram.WebApp.onEvent('mainButtonClicked', function(){
            const name = document.getElementById('inputName').value;
            const phone = document.getElementById('inputPhone').value;
            const nick = document.getElementById('inputNick').value;
            const delivery = document.getElementById('inputDelivery').value;

            if (!name || !phone) {
                tg.showPopup({title: '–û—à–∏–±–∫–∞', message: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ò–º—è –∏ –¢–µ–ª–µ—Ñ–æ–Ω'});
                return;
            }

            const orderData = {
                type: 'ORDER',
                customer: { name, phone, nick, delivery },
                items: cart,
                total: calculateTotal()
            };

            tg.sendData(JSON.stringify(orderData));
        });

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        function previewImage(url) {
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∑—É–º–∞, –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –∑–∞–≥–ª—É—à–∫–∞
        }

    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BAZIS Store</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #0f0f0f;
            --card-bg: #181818;
            --accent-color: #ff5722;
            --text-main: #ffffff;
            --text-sec: #888888;
            --border-color: #2a2a2a;
            --green-color: #2ecc71;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 15px;
            padding-bottom: 80px; /* –û—Ç—Å—Ç—É–ø –ø–æ–¥ –∫–Ω–æ–ø–∫—É –∫–æ—Ä–∑–∏–Ω—ã */
            -webkit-tap-highlight-color: transparent;
        }

        /* --- –ù–ê–í–ò–ì–ê–¶–ò–Ø –ò –®–ê–ü–ö–ê --- */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background: var(--bg-color);
            padding: 10px 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }

        .logo { font-size: 24px; font-weight: 800; color: var(--accent-color); text-transform: uppercase; }

        .back-btn {
            display: none; /* –°–∫—Ä—ã—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π */
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-main);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        /* --- –°–¢–†–ê–ù–ò–¶–´ (–≠–ö–†–ê–ù–´) --- */
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }

        /* --- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ (–ë–†–ï–ù–î–´) --- */
        .brand-title { font-size: 28px; font-weight: 700; margin: 20px 0 10px 0; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        .menu-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 15px;
            min-height: 140px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            overflow: hidden;
        }
        .menu-card img {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; opacity: 0.4; z-index: 0;
        }
        .menu-card span { position: relative; z-index: 1; font-weight: 700; font-size: 18px; }

        /* --- –°–ü–ò–°–û–ö –¢–û–í–ê–†–û–í --- */
        .product-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .prod-img {
            width: 100%; height: 200px; object-fit: contain;
            background: #000; border-radius: 8px; margin-bottom: 10px;
        }

        .prod-title { font-size: 18px; font-weight: 700; margin-bottom: 5px; }
        .prod-price { font-size: 18px; color: var(--accent-color); font-weight: bold; margin-bottom: 10px; }

        .prod-details {
            font-size: 12px; color: var(--text-sec);
            display: grid; grid-template-columns: 1fr 1fr; gap: 5px;
            margin-bottom: 15px; background: #111; padding: 8px; border-radius: 6px;
        }
        .detail-row b { color: #fff; margin-right: 4px; }

        .add-btn {
            background: var(--text-main); color: #000;
            border: none; padding: 12px; border-radius: 8px;
            font-weight: 700; width: 100%; cursor: pointer;
        }
        .add-btn:active { opacity: 0.8; }

        /* --- –ö–û–†–ó–ò–ù–ê –ò –§–û–†–ú–ê --- */
        .cart-item {
            background: #111; border-bottom: 1px solid var(--border-color);
            padding: 10px; display: flex; justify-content: space-between; align-items: center;
        }
        .cart-item-info { display: flex; flex-direction: column; }
        .remove-btn { color: #ff3b30; background: none; border: none; font-weight: bold; font-size: 20px; }

        .form-group { margin-bottom: 15px; }
        .form-label { font-size: 12px; color: var(--text-sec); margin-bottom: 5px; display: block; }
        .form-input, .form-select {
            width: 100%; padding: 12px; background: var(--card-bg);
            border: 1px solid var(--border-color); color: #fff; border-radius: 8px;
            font-size: 16px; box-sizing: border-box;
        }
        .form-input:focus { border-color: var(--accent-color); outline: none; }

        /* --- –ü–õ–ê–í–ê–Æ–©–ê–Ø –ö–ù–û–ü–ö–ê –ö–û–†–ó–ò–ù–´ --- */
        .fab-cart {
            position: fixed; bottom: 20px; right: 20px;
            background: var(--accent-color); color: white;
            width: 60px; height: 60px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 20px rgba(255, 87, 34, 0.4);
            z-index: 200; transition: transform 0.2s;
        }
        .fab-cart:active { transform: scale(0.9); }
        .cart-count {
            position: absolute; top: 0; right: 0;
            background: white; color: var(--accent-color);
            font-size: 12px; font-weight: bold;
            width: 20px; height: 20px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <!-- –®–ê–ü–ö–ê -->
    <div class="header">
        <button id="backBtn" class="back-btn" onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="logo">BAZIS</div>
        <div style="width: 50px;"></div> <!-- –ü—É—Å—Ç–æ–π –±–ª–æ–∫ –¥–ª—è —Ü–µ–Ω—Ç—Ä–æ–≤–∫–∏ -->
    </div>

    <!-- –≠–ö–†–ê–ù 1: –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
    <div id="homePage" class="page active">

        <div class="brand-title">Stone Island</div>
        <div class="grid">
            <div class="menu-card" onclick="openCategory('Stone Island', 'T-Shirts')">
                <span>–§—É—Ç–±–æ–ª–∫–∏</span>
            </div>
            <div class="menu-card" onclick="openCategory('Stone Island', 'Hoodies')">
                <span>–•—É–¥–∏</span>
            </div>
            <div class="menu-card" onclick="openCategory('Stone Island', 'Outerwear')">
                <span>–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞</span>
            </div>
            <div class="menu-card" style="border-color: var(--accent-color);" onclick="openCategory('Stone Island', 'Vintage')">
                <span style="color: var(--accent-color)">üíé –í–∏–Ω—Ç–∞–∂</span>
            </div>
        </div>

        <div class="brand-title">C.P. Company</div>
        <div class="grid">
            <div class="menu-card" onclick="openCategory('CP Company', 'T-Shirts')">
                <span>–§—É—Ç–±–æ–ª–∫–∏</span>
            </div>
            <div class="menu-card" onclick="openCategory('CP Company', 'Hoodies')">
                <span>–•—É–¥–∏</span>
            </div>
        </div>
    </div>

    <!-- –≠–ö–†–ê–ù 2: –°–ü–ò–°–û–ö –¢–û–í–ê–†–û–í -->
    <div id="productsPage" class="page">
        <h2 id="categoryTitle" style="margin-bottom: 15px;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</h2>
        <div id="productsList">
            <!-- –°—é–¥–∞ JS –≤—Å—Ç–∞–≤–∏—Ç —Ç–æ–≤–∞—Ä—ã -->
        </div>
    </div>

    <!-- –≠–ö–†–ê–ù 3: –ö–û–†–ó–ò–ù–ê –ò –û–§–û–†–ú–õ–ï–ù–ò–ï -->
    <div id="cartPage" class="page">
        <h2 style="margin-bottom: 20px;">–í–∞—à –∑–∞–∫–∞–∑</h2>
        <div id="cartItemsList">
            <!-- –¢–æ–≤–∞—Ä—ã –∫–æ—Ä–∑–∏–Ω—ã -->
            <p style="color: #888; text-align: center;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
        </div>

        <div style="border-top: 1px solid #333; margin: 20px 0;"></div>

        <h3>–î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏</h3>
        <div class="form-group">
            <label class="form-label">–§–ò–û</label>
            <input type="text" class="form-input" id="inputName" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
        </div>
        <div class="form-group">
            <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="tel" class="form-input" id="inputPhone" placeholder="+7 900 ...">
        </div>
        <div class="form-group">
            <label class="form-label">–ù–∏–∫ –≤ Telegram</label>
            <input type="text" class="form-input" id="inputNick" placeholder="@username">
        </div>
        <div class="form-group">
            <label class="form-label">–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏</label>
            <select class="form-select" id="inputDelivery">
                <option value="cdek">–°–î–≠–ö (–¥–æ –ø—É–Ω–∫—Ç–∞ –≤—ã–¥–∞—á–∏)</option>
                <option value="yandex">–Ø–Ω–¥–µ–∫—Å –î–æ—Å—Ç–∞–≤–∫–∞</option>
                <option value="pickup">–°–∞–º–æ–≤—ã–≤–æ–∑ (–ú–æ—Å–∫–≤–∞)</option>
            </select>
        </div>
    </div>

    <!-- –ü–õ–ê–í–ê–Æ–©–ê–Ø –ö–ù–û–ü–ö–ê –ö–û–†–ó–ò–ù–´ -->
    <div class="fab-cart" onclick="openCart()">
        üõí
        <div class="cart-count" id="cartCount">0</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        tg.MainButton.color = "#ff5722"; // –û—Ä–∞–Ω–∂–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞ "–û—Ñ–æ—Ä–º–∏—Ç—å"
        tg.MainButton.textColor = "#ffffff";

        // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• –¢–û–í–ê–†–û–í (–ó–ê–ü–û–õ–ù–Ø–¢–¨ –ó–î–ï–°–¨) ---
        // id: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä
        // brand: –∏–º—è –±—Ä–µ–Ω–¥–∞ (–∫–∞–∫ –≤ –∫–Ω–æ–ø–∫–∞—Ö –º–µ–Ω—é)
        // category: –∫–∞—Ç–µ–≥–æ—Ä–∏—è (–∫–∞–∫ –≤ –∫–Ω–æ–ø–∫–∞—Ö –º–µ–Ω—é)
        const PRODUCTS_DB = [
            {
                id: 1,
                brand: 'Stone Island',
                category: 'T-Shirts',
                title: 'Archivio Tee Black',
                price: 18500,
                size: 'L',
                color: 'Black',
                condition: 'New with tags',
                composition: '100% Cotton',
                cert: 'CLG 123 456 789',
                img: 'https://image.goxip.com/u4g1y8y_s2r4s3r8x4t2r5u2u2/stone-island-white-scraping-t-shirt.jpg'
            },
            {
                id: 2,
                brand: 'Stone Island',
                category: 'Hoodies',
                title: 'Shadow Project Hoodie',
                price: 45000,
                size: 'XL',
                color: 'Olive',
                condition: '9/10',
                composition: 'Fleece',
                cert: 'QR Verified',
                img: 'https://cdn-images.farfetch-contents.com/17/60/89/24/17608924_36852642_1000.jpg'
            },
            {
                id: 3,
                brand: 'Stone Island',
                category: 'Vintage',
                title: 'Raso Gommato 2008',
                price: 85000,
                size: 'M',
                color: 'Navy',
                condition: 'Vintage 8/10',
                composition: 'Rubberized Cotton',
                cert: 'ART Number',
                img: 'https://media.endclothing.com/media/f_auto,q_auto:eco,w_400/prodmedia/media/catalog/product/2/0/20-01-2022_SI_MEMBRANATC_LOW.jpg'
            },
             {
                id: 4,
                brand: 'CP Company',
                category: 'T-Shirts',
                title: 'Logo Patch Tee',
                price: 12000,
                size: 'S',
                color: 'White',
                condition: 'New',
                composition: 'Cotton',
                cert: 'Certilogo',
                img: 'https://images.flannels.com/images/imgzoom/59/59063101_xxl.jpg'
            }
        ];

        // --- –õ–û–ì–ò–ö–ê –ö–û–†–ó–ò–ù–´ ---
        let cart = [];

        function addToCart(productId) {
            const product = PRODUCTS_DB.find(p => p.id === productId);
            if(product) {
                cart.push(product);
                updateCartUI();
                tg.HapticFeedback.notificationOccurred('success');
                // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
                const btn = event.target;
                const originalText = btn.innerText;
                btn.innerText = "–í –∫–æ—Ä–∑–∏–Ω–µ ‚úÖ";
                setTimeout(() => btn.innerText = originalText, 1000);
            }
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
            renderCartPage(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ—Ä–∑–∏–Ω—ã
            tg.HapticFeedback.selectionChanged();
        }

        function updateCartUI() {
            document.getElementById('cartCount').innerText = cart.length;
            if (cart.length > 0 && document.getElementById('cartPage').style.display === 'block') {
                tg.MainButton.show();
                tg.MainButton.setText(`–û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó (${calculateTotal()} ‚ÇΩ)`);
            } else {
                tg.MainButton.hide();
            }
        }

        function calculateTotal() {
            return cart.reduce((sum, item) => sum + item.price, 0);
        }

        // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');

            const backBtn = document.getElementById('backBtn');
            if (pageId === 'homePage') {
                backBtn.style.display = 'none';
                tg.MainButton.hide();
            } else {
                backBtn.style.display = 'block';
            }

            window.scrollTo(0,0);
        }

        function goHome() {
            showPage('homePage');
        }

        function openCategory(brand, category) {
            const list = document.getElementById('productsList');
            document.getElementById('categoryTitle').innerText = `${brand} - ${category}`;
            list.innerHTML = '';

            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã
            const items = PRODUCTS_DB.filter(p => p.brand === brand && p.category === category);

            if (items.length === 0) {
                list.innerHTML = '<p style="color:#888">–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø–æ–∫–∞ –ø—É—Å—Ç–æ.</p>';
            }

            items.forEach(item => {
                const el = document.createElement('div');
                el.className = 'product-card';
                el.innerHTML = `
                    <img src="${item.img}" class="prod-img">
                    <div class="prod-title">${item.title}</div>
                    <div class="prod-price">${item.price.toLocaleString()} ‚ÇΩ</div>

                    <div class="prod-details">
                        <div class="detail-row"><b>–†–∞–∑–º–µ—Ä:</b> ${item.size}</div>
                        <div class="detail-row"><b>–¶–≤–µ—Ç:</b> ${item.color}</div>
                        <div class="detail-row"><b>–°–æ—Å—Ç:</b> ${item.condition}</div>
                        <div class="detail-row"><b>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:</b> ${item.cert}</div>
                        <div class="detail-row" style="grid-column: span 2"><b>–°–æ—Å—Ç–∞–≤:</b> ${item.composition}</div>
                    </div>

                    <button class="add-btn" onclick="addToCart(${item.id})">–í –ö–û–†–ó–ò–ù–£</button>
                `;
                list.appendChild(el);
            });

            showPage('productsPage');
        }

        function openCart() {
            renderCartPage();
            showPage('cartPage');
            updateCartUI(); // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
        }

        function renderCartPage() {
            const list = document.getElementById('cartItemsList');
            list.innerHTML = '';

            if (cart.length === 0) {
                list.innerHTML = '<p style="color: #888; text-align: center; padding: 20px;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
                tg.MainButton.hide();
                return;
            }

            cart.forEach((item, index) => {
                const el = document.createElement('div');
                el.className = 'cart-item';
                el.innerHTML = `
                    <div class="cart-item-info">
                        <span style="font-weight:bold">${item.title}</span>
                        <span style="font-size:12px; color:#888">${item.size} | ${item.price.toLocaleString()} ‚ÇΩ</span>
                    </div>
                    <button class="remove-btn" onclick="removeFromCart(${index})">√ó</button>
                `;
                list.appendChild(el);
            });
        }

        // --- –û–¢–ü–†–ê–í–ö–ê –ó–ê–ö–ê–ó–ê ---
        Telegram.WebApp.onEvent('mainButtonClicked', function(){
            const name = document.getElementById('inputName').value;
            const phone = document.getElementById('inputPhone').value;
            const nick = document.getElementById('inputNick').value;
            const delivery = document.getElementById('inputDelivery').value;

            if (!name || !phone) {
                tg.showPopup({title: '–û—à–∏–±–∫–∞', message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω', buttons: [{type: 'ok'}]});
                return;
            }

            const orderData = {
                type: 'ORDER',
                customer: { name, phone, nick, delivery },
                items: cart,
                total: calculateTotal()
            };

            tg.sendData(JSON.stringify(orderData));
        });

    </script>
</body>
</html>
